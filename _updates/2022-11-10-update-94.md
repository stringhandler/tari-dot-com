---
layout: update
tag: Developer Update
date: 2022-11-10
author: Stringhandler
thumbnail: update-background.jpg
title: A First Look at Tari Contracts
class: subpage
---

## A First Look at Tari Contracts


This is the first of a series of blogposts on covering the progress of creating smart contracts on the Tari Digital Asset Network (DAN) layer. 

This week we'll look at the actual contract code that is written in Rust. At the moment, the functionality is exceedingly basic AND SUBJECT TO CHANGE DRASTICALLY,
so I wouldn't recommend anything other than experimental testing at this stage.

Let's look at a basic contract:

```rust
use tari_template_macros::template;

#[template]
mod counter {
    pub struct Counter {
        value: u32,
    }

    impl Counter {
        pub fn new() -> Self {
            Self { value: 0 }
        }

        pub fn value(&self) -> u32 {
            self.value
        }

        pub fn increase(&mut self) {
            self.value += 1;
        }
    }
}
```

The first thing you may notice is that there are no coins or tokens or NFTs here. The community is still testing out many strategies in order to 
find the most ergonomic and safe way of exposing these to developers.

The next thing you may notice is the `tari_template_macros` include at the top. There are a few dependencies you'll need to add to your `Cargo.toml` file.
The easiest way to get started with a contract is to use 
the `cargo-generate` template on [Github](https://github.com/tari-project/wasm-template). 

First, after making sure you have `rustc` and `cargo` installed, install `cargo-generate`:

```shell
cargo install cargo-generate
```

Then, in a folder of your choosing, run and type in a project name (e.g. CounterDemo):

```shell
$ cargo generate https://github.com/tari-project/wasm-template.git counter

 Favorite `https://github.com/tari-project/wasm-template.git` not found in config, using it as a git repository: https://github.com/tari-project/wasm-template.git

 Project Name : CounterDemo

Renaming project called `CounterDemo` to `counter-demo`...
 Destination: C:\projects\counter-demo ...
 Generating template ...
[ 1/12]   Done: .cargo\config
[ 2/12]   Done: .cargo
[ 3/12]   Done: .gitignore
[ 4/12]   Done: Cargo.toml
[ 5/12]   Done: package\Cargo.toml
[ 6/12]   Done: package\src\lib.rs
[ 7/12]   Done: package\src
[ 8/12]   Done: package
[ 9/12]   Done: tests\Cargo.toml
[10/12]   Done: tests\tests\test.rs
[11/12]   Done: tests\tests
[12/12]   Done: tests
 Moving generated files into: `C:\projects\counter-demo`...
 Initializing a fresh Git repository
 Done! New project created C:\projects\counter-demo

```

The actual contract is in `package\src\lib.rs`. There are also some integration tests scaffolded under `tests`. We won't go into those this week.

Let's run the tests first to make sure we've got everything installed.

```
$ cargo test

.....
    Finished test [unoptimized + debuginfo] target(s) in 16.38s
     Running tests\test.rs (target\debug\deps\test-10fba866873c5eef.exe)

running 1 test
test test::test_increment ... ok

test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 5.56s

```

The Tari DAN layer doesn't actually run Rust contracts though, each contract runs as a WASM in it's own sandbox of sorts. Before we can register this code on the base layer we need to compile it to WASM.


```rust
cd package
cargo build-wasm
```

> NOTE: The Rust code in `tests` does not compile to WASM because it depends on the Tari engine code that hosts and executes WASM contracts, so running `cargo build-wasm` in the root folder will fail.

> NOTE: The `build-wasm` command is a `cargo` alias defined in `.cargo/config`". If you are having trouble you can also run `cargo build --target=wasm32-unknown-unknown`
```toml
[alias]
build-wasm = "build --target=wasm32-unknown-unknown"
```

In the next step, we'll register this contract on the Tari base layer and invoke 
some methods on it.

